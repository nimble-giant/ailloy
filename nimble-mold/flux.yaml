# Flux values for ailloy-defaults mold.
# Override any value here or in your project's ailloy.yaml under templates.flux.

project:
  board: "Engineering"
  # organization: ""  # required â€” set in your project config
  # id: ""            # optional â€” set in your project config
  list: "gh project list --owner <your-org>"

scm:
  provider: "GitHub"
  cli: "gh"
  base_url: "https://github.com"

issue:
  view: 'gh issue view <URL or issue-number> --json title,body,author,state,labels,assignees,milestone,number,url,comments'
  create: 'gh issue create --title "<title>" --body "<body>"'
  create_with_labels: 'gh issue create --title "<title>" --body "<body>" --label "<labels>"'
  add_to_project: 'gh issue edit <issue-number> --add-project "<project-name>"'
  list: "gh issue list"
  search: "gh issue search"

pr:
  check: "gh pr view --json number,title,url,state"
  find_for_branch: 'gh pr list --state open --head "$CURRENT_BRANCH" --json number,title'
  create: "gh pr create"
  view: "gh pr view <pr-number> --json title,body,author,state,mergeable"
  view_reviews: "gh pr view <pr-number> --json reviewDecision,latestReviews"
  view_full: "gh pr view <pr-number> --json title,body,author,state,mergeable,reviewDecision,labels,assignees"
  view_files: "gh pr view <pr-number> --json files"
  diff: "gh pr diff <pr-number> --color=never"
  update_body: "gh pr edit --body-file <description-file>"
  comment: 'gh pr comment <pr-number> --body "<comment>"'
  request_review: "gh pr edit <pr-number> --add-reviewer <reviewer-username>"

api:
  base: "gh api"
  pr_review_comments: "gh api repos/:owner/:repo/pulls/<pr-number>/comments --paginate"
  pr_conversation_comments: "gh api repos/:owner/:repo/issues/<pr-number>/comments --paginate"
  reply_to_review_comment: |-
    gh api repos/:owner/:repo/pulls/<pr-number>/comments/<comment-id>/replies \
      --method POST \
      --field body="<reply-message>"
  reply_to_conversation_comment: |-
    gh api repos/:owner/:repo/issues/<pr-number>/comments \
      --method POST \
      --field body="<reply-message>"
  pr_reviews: "gh api repos/:owner/:repo/pulls/<pr-number>/reviews --paginate"
  file_content: "gh api repos/:owner/:repo/contents/<file-path>?ref=<ref>"
  post_review: |-
    gh api repos/:owner/:repo/pulls/<pr-number>/reviews \
      --method POST \
      --field body="<summary-comment>" \
      --field event="<REQUEST_CHANGES|APPROVE|COMMENT>" \
      --field comments='[
        {
          "path": "src/api/users.js",
          "line": 42,
          "body": "ðŸš¨ **Security Issue**: This code is vulnerable to SQL injection..."
        }
      ]'

auth:
  check: "gh auth status"
  login: "gh auth login"
